{"version":3,"sources":["./src/app/shipment-details/shipment-details.page.html","./src/app/shipment-details/shipment-details.module.ts","./src/app/shipment-details/shipment-details.page.scss","./src/app/shipment-details/shipment-details.page.ts"],"names":[],"mappings":"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","file":"shipment-details-shipment-details-module-es2015.js","sourcesContent":["module.exports = \"<ion-header>\\n  <ion-toolbar>\\n    <ion-title>shipmentDetails</ion-title>\\n  </ion-toolbar>\\n</ion-header>\\n\\n<ion-content class=\\\"io-padding\\\">\\n  <div id=\\\"map_canvas\\\" #map_canvas></div>\\n</ion-content>\\n\"","import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { FormsModule } from '@angular/forms';\nimport { Routes, RouterModule } from '@angular/router';\n\nimport { IonicModule } from '@ionic/angular';\n\nimport { ShipmentDetailsPage } from './shipment-details.page';\n\nconst routes: Routes = [\n  {\n    path: '',\n    component: ShipmentDetailsPage\n  }\n];\n\n@NgModule({\n  imports: [\n    CommonModule,\n    FormsModule,\n    IonicModule,\n    RouterModule.forChild(routes)\n  ],\n  declarations: [ShipmentDetailsPage]\n})\nexport class ShipmentDetailsPageModule {}\n","module.exports = \"#map_canvas {\\n  width: 100%;\\n  height: 100%;\\n}\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9Vc2Vycy9zcG90bGF5ZXIvRG93bmxvYWRzL2NhcmdvLWVtcGxveWVlL3NyYy9hcHAvc2hpcG1lbnQtZGV0YWlscy9zaGlwbWVudC1kZXRhaWxzLnBhZ2Uuc2NzcyIsInNyYy9hcHAvc2hpcG1lbnQtZGV0YWlscy9zaGlwbWVudC1kZXRhaWxzLnBhZ2Uuc2NzcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtFQUNJLFdBQUE7RUFDQSxZQUFBO0FDQ0oiLCJmaWxlIjoic3JjL2FwcC9zaGlwbWVudC1kZXRhaWxzL3NoaXBtZW50LWRldGFpbHMucGFnZS5zY3NzIiwic291cmNlc0NvbnRlbnQiOlsiI21hcF9jYW52YXMge1xuICAgIHdpZHRoOiAxMDAlO1xuICAgIGhlaWdodDogMTAwJTtcbn0iLCIjbWFwX2NhbnZhcyB7XG4gIHdpZHRoOiAxMDAlO1xuICBoZWlnaHQ6IDEwMCU7XG59Il19 */\"","import { AfterViewInit, Component, ElementRef, OnInit, ViewChild } from '@angular/core';\nimport { BackgroundGeolocationConfig, BackgroundGeolocation, BackgroundGeolocationEvents, BackgroundGeolocationResponse, BackgroundGeolocationCurrentPositionConfig } from '@ionic-native/background-geolocation/ngx';\nimport { Geolocation } from '@ionic-native/geolocation/ngx';\nimport { GoogleMap, GoogleMaps, GoogleMapsEvent, Marker, MarkerClusterIcon, MarkerClusterOptions, MarkerOptions } from '@ionic-native/google-maps';\n\n@Component({\n  selector: 'app-shipment-details',\n  templateUrl: './shipment-details.page.html',\n  styleUrls: ['./shipment-details.page.scss'],\n})\nexport class ShipmentDetailsPage implements OnInit, AfterViewInit {\n  @ViewChild('map_canvas', { static: false }) mapCanvas: ElementRef;\n\n  constructor(\n    private backgroundGeolocation:BackgroundGeolocation,\n    private geolocation:Geolocation\n  ) { }\n\n  ngAfterViewInit(): void {\n  \n  }\n\n  lat;\n  long\n  ngOnInit() {\n   \n  }\n\n  map:GoogleMap\n  ionViewWillEnter() {\n    console.log('entriee')\n    this.geolocation.getCurrentPosition().then(coords => {\n      console.log('coords', coords)\n      this.lat = coords.coords.latitude\n      this.long = coords.coords.longitude;\n      this.loadMap()\n    })\n\n    // setInterval(() => {\n    //   this.geolocation.getCurrentPosition().then(coords => {\n    //     console.log('coords', coords)\n    //     this.fetchDate(coords.coords.latitude, coords.coords.longitude, true)\n    //   })\n    // }, 5000)\n\n  }\n\n  ionViewWillLeave() {\n    this.backgroundGeolocation.stop();\n\n  }\n  loadMap() {\n    this.map = GoogleMaps.create(this.mapCanvas.nativeElement, {\n      camera: {\n        target: {\n          lat: this.lat,\n          lng: this.long\n        },\n        zoom: 10,\n        \n      }\n    });\n\n    \n    this.map.on(GoogleMapsEvent.MAP_READY).subscribe(e => {\n      let option:MarkerOptions = {\n        position:{\n          lat: this.lat,\n          lng: this.long\n        }\n      }\n      this.map.addMarker(option)\n      this.initializeBackgroundPosition()\n    })\n  }\n\n  fetchDate(lat, lng, draw = false) {\n    this.map.clear();\n    this.map.animateCamera({\n      target: {\n        lat,\n        lng,\n      },\n      zoom: 15,\n      tilt: 30\n    });\n    let option:MarkerOptions = {\n      position:{\n        lat: this.lat,\n        lng: this.long\n      }\n    }\n    this.map.addMarker(option)\n\n    if(draw) {\n      let icon:MarkerClusterIcon = {\n        url:'assets/img/marker_delivery.svg', min:10, max:7\n      }\n      let opts:MarkerClusterOptions = {\n        markers: [option],\n        icons:[icon]\n      } \n      this.map.addMarkerCluster(opts)\n    }\n    \n  }\n\n\n  initializeBackgroundPosition() {\n    // this.geoLocation.watchPosition({}).subscribe(position => {\n    //   console.log(position)\n    // })\n\n    const config: BackgroundGeolocationConfig = {\n      notificationsEnabled: false,\n      debug: false, //  enable this hear sounds for background-geolocation life-cycle.\n      stopOnTerminate: false,\n      // interval:1000,\n      startForeground:true,\n      saveBatteryOnBackground:true,\n      desiredAccuracy: 10,\n      stationaryRadius: 50,\n      distanceFilter: 50,\n    };\n\n    this.backgroundGeolocation.configure(config)\n    .then(() => {\n\n      this.backgroundGeolocation.on(BackgroundGeolocationEvents.location).subscribe((location: BackgroundGeolocationResponse) => {\n      console.log('background location', location);\n      // this.pusher.send_event('updateLocation', location, this.authService.userData.id )\n\n        this.fetchDate(location.latitude, location.longitude, true)\n        alert(`lat=${location.latitude}  lng=${location.longitude}, time=${new Date(location.time)}`)\n\n        // IMPORTANT:  You must execute the finish method here to inform the native plugin that you're finished,\n        // and the background-task may be completed.  You must do this regardless if your operations are successful or not.\n        // IF YOU DON'T, ios will CRASH YOUR APP for spending too much time in the background.\n        // if(this.platform.is('ios')) this.backgroundGeolocation.finish(); // FOR IOS ONLY\n      });\n\n    });\n\n    this.backgroundGeolocation.start();\n\n   \n  }\n\n}\n"],"sourceRoot":""}